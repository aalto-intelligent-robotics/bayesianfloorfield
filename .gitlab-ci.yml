image: "python:3.9.1"

before_script:
  - python -m pip install --upgrade pip
  - pip install black flake8 mypy pytest pytest-cov types-PyYAML
  - if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

stages:
  - Analysis
  - Test

black:
  stage: Analysis
  script:
  - black --check .

flake8:
  stage: Analysis
  script:
  - flake8 .

mypy:
  stage: Analysis
  script:
  - mypy .

unit_test:
  stage: Test
  script:
  - pytest --cov=deepflow --cov-report term-missing:skip-covered
